# 2. Identity_and_Access_Management(IAM)

## IAM 개요

- AWS 계정 및 권한 관리 서비스

- AWS 서비스와 리소스에 대한 액세스 관리

- 사용자, 그룹, 역할, 정책으로 구성

- 리전에 속하는 서비스가 아닌 글로벌 서비스

- 계정 보안 강화를 위해
  
  - 루트 계정(AWS 회원가입 시 만들어지는 계정)은 최초 사용자 계정 생성 이후 가능하면 사용하지 말 것
  
  - 사용자 계정(IAM 계정)으로 서비스를 사용하고 사용자는 필요한 최소한의 권한만 부여(최소권한의 원칙)
  
  - 루트계정과 개별 사용자 계정에 강력한 암호 정책과 멀티팩터 인증(MFA) 적용
  
  - 사용자의 암호에 대한 복잡성 요구 사항과 의무 교체 주기를 정의
  
  - 액세스 키(Access Key)는 공유하지 말 것



## IAM 루트 사용자 자격 증명을 요구하는 작업

- 계정 설정을 변경(계정 이름, 이메일 주소, 루트 사용자 암호 및 루트 사용자 액세스 키)
  
  - 연락처 정보, 결제 통화 기본 설정 및 region과 같은 기타 계정 설정에는 루트 사용자 자격 증명이 필요하지 않음

- IAM 사용자 권한을 복원
  
  - IAM 관리자가 실수로 권한을 취소하면 루트 사용자로 로그인하여 정책을 편집하고 해당 권한을 복원

- Billing and Cost Management 콘솔에 대한 IAM 액세스 활성화

- 특정 세금 계산서를 조회

- AWS 계정을 닫음

- AWS 지원 플랜(Support Plan)을 변경하거나 AWS 지원 플랜을 취소

- 예약 인스턴스 마켓플레이스에 판매자로 등록

- MFA(멀티 팩터 인증) Delete를 활성화 하도록 Amazon S3 버킷을 구성

- 잘못된 VPC ID 또는 VPC 엔드포인트 ID가 들어 있는 Amazon S3 버킷 정책을 편집하거나 삭제

- CovCloud 등록



### IAM - 액세스 관리

- 사용자(User) : 사람, ID, 계정

- 그룹(Group) : 사용자의 모음
  
  - (ex - 재무팀, 개발팀 등)

- 역할(Role) : AWS 리소스에서 사용하는 자격 증명
  
  - (ex - AWS EC2에서 실행되는 애플리케이션이 Amazon S3, Amazon RDS와 같은 AWS 리소스에 액세스하는 권한)



- **정책(Policy) : User, Group, Role에 대한 권한 정의,  JSON 문서 형식으로 구성**
  
  - 어떤 것을 할 수 있고, 어떤 것을 할 수 없는지



### IAM - 정책 문서 구조

- JSON 문서 형식으로 이루어짐

- 정책이 명시되지 않는 경우 기본적으로 모든 요청이 거부(Deny)됨

> IAM 정책 JSON 문서 구조
> 
> - Effect : Statement에 대한 Access 또는 Deny
> 
> - Action : 권한에 대한 작업 목록
> 
> - Resource : 권한이 적용되는 리소스
> 
> - Condition : 정책이 적용되는 세부 조건(옵션 사항)
> 
> ```json
> {
>     "Statement" : [{
>         "Effect" : "effect",
>         "Action" : "action",
>         "Resource" : "arn",
>         "Condition" : {
>             "condition" : {
>                 "key" : "value"
>                 }
>             }
>         }    
>     ]
> }
> ```



### IAM - 역할

- AWS 리소스에서 사용하는 자격증명

- 특정 AWS 서비스가 다른 AWS 서비스에 액세스 하여 작업을 수행할 때 필요한 권한

- 정책을 연결하여 IAM 역할에 작업 수행에 필요한 권한을 부여

- 만일, EC2에서 실행되는 애플리케이션이 AWS S3와 AWS RDS 액세스 권한이 필요할 때 역할 사용



### IAM 자격증명 보고서(Credentials Report)

- 계정의 모든 사용자와 암호, 액세스 키, MFA 디바이스 등 이들의 자격 증명 상태를 나열하는 자격 증명 보고서를 생성하고 다운로드

- 보고서 내용
  
  - 사용자의 표시 이름
  
  - 사용자의 Amazon 리소스 이름(ARN)
  
  - 사용자가 생성된 날짜 및 시간
  
  - 사용자의 암호가 마지막으로 사용된 날짜 및 시간
  
  - 계정에 암호 교체를 요구하는 암호 정책이 있는 경우, 사용자가 새 암호를 설정해야 할 때 이 필드에 날짜 및 시간
  
  - 사용자에 대해 멀티 팩터 인증(MFA) 디바이스를 사용하도록 설정되었는지 여부
  
  - 사용자에게 액세스 키가 있고 액세스 키의 상태가 활성인지 여부
  
  - 사용자의 액세스 키가 생성되었거나 마지막으로 변경된 날짜 및 시간
  
  - 사용자의 액세스 키를 AWS API 요청 서명에 마지막으로 사용한 날짜 및 시간
  
  - 액세스 키가 마지막으로 사용된 AWS 리전
  
  - 액세스 키로 가장 최근에 액세스한 AWS 제품
